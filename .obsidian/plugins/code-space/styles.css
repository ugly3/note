/* =================================================================
   Code Space 容器样式
   ================================================================= */
.code-space-container {
    height: 100%;
    min-height: 0;
    width: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    background-color: var(--background-primary);
    position: relative;
    /* 强制覆盖 Obsidian 的选区颜色变量 */
    --text-selection: #FF5555;
    --text-highlight-bg: rgba(255, 215, 0, 0.6);
}

/* =================================================================
   浮动搜索按钮 (已移除)
   ================================================================= */


/* 搜索选中高亮 - 淡红色，最高优先级 - 使用 body 前缀增强权重 */
body .code-space-container .cm-editor .cm-scroller .cm-content .cm-selectionBackground,
body .code-space-container .cm-selectionBackground,
body .code-space-container ::selection,
body .code-space-container .cm-content ::selection,
body .code-space-container .cm-line::selection {
    background-color: #FF5555 !important;
    color: #FFFFFF !important;
}

/* 活动行内的选区也必须是淡红色 */
body .code-space-container .cm-activeLine .cm-selectionBackground,
body .code-space-container .cm-activeLine::selection {
    background-color: #FF5555 !important;
    color: #FFFFFF !important;
}

.code-space-container .cm-editor {
    flex: 1 1 auto;
    min-height: 0;
    height: auto !important;
    font-family: var(--font-monospace), 'JetBrains Mono', 'Fira Code', 'Cascadia Code', 'Source Code Pro', Consolas, 'Courier New', monospace;
    font-feature-settings: "liga" 1, "calt" 1;
    -webkit-font-smoothing: antialiased;
}

/* 优化编辑器行号 */
.cm-gutters {
    background-color: var(--background-primary) !important;
    color: var(--text-muted);
    border-right: 1px solid var(--background-modifier-border);
    min-width: 32px;
    z-index: 10;
    user-select: none !important; /* 禁止选中行号区域 */
}

.code-space-container .cm-lineNumbers .cm-gutterElement {
    padding: 0 8px !important;
    background-color: var(--background-primary) !important;
    min-width: 24px;
    text-align: right;
    font-variant-numeric: tabular-nums;
}

/* 优化光标 */
.code-space-container .cm-cursor,
.code-space-container .cm-dropCursor {
    border-left-width: 2px;
    border-left-color: var(--interactive-accent) !important;
}

/* 优化选区 */
.code-space-container .cm-selectionBackground {
    background-color: hsla(var(--interactive-accent-hsl), 0.2) !important;
}

/* 优化滚动条 */
.code-space-container .cm-scroller {
    overflow: auto;
}

.code-space-container .cm-scroller::-webkit-scrollbar {
    width: 12px;
    height: 12px;
}

.code-space-container .cm-scroller::-webkit-scrollbar-track {
    background: transparent;
}

.code-space-container .cm-scroller::-webkit-scrollbar-thumb {
    background: var(--background-modifier-border-hover);
    border-radius: 6px;
    border: 3px solid transparent;
    background-clip: content-box;
}

.code-space-container .cm-scroller::-webkit-scrollbar-thumb:hover {
    background: var(--text-muted);
    border: 3px solid transparent;
    background-clip: content-box;
}

/* =================================================================
   Dashboard
   ================================================================= */
.code-dashboard-root {
    padding: 24px 32px;
    height: 100%;
    overflow-y: auto;
    overflow-x: hidden;
    width: 100%;
    background-color: var(--background-primary);
}

/* 平滑滚动 */
.code-dashboard-root {
    scroll-behavior: smooth;
}

/* 优化 Dashboard 滚动条 */
.code-dashboard-root::-webkit-scrollbar {
    width: 10px;
}

.code-dashboard-root::-webkit-scrollbar-track {
    background: transparent;
}

.code-dashboard-root::-webkit-scrollbar-thumb {
    background: var(--background-modifier-border-hover);
    border-radius: 5px;
    border: 2px solid transparent;
    background-clip: content-box;
}

.code-dashboard-root::-webkit-scrollbar-thumb:hover {
    background: var(--text-muted);
    border: 2px solid transparent;
    background-clip: content-box;
}

/* Header */
.code-dashboard-header-container {
    margin-bottom: 16px;
    display: flex;
    flex-direction: column;
    gap: 8px; /* 增加标题和副标题之间的间距 */
}

.code-dashboard-title-group {
    display: flex;
    align-items: center; /* 垂直居中对齐 */
    gap: 12px;
    min-height: 40px; /* 确保有足够高度容纳内容 */
}

.code-dashboard-title-group h1 {
    margin: 0;
    padding: 0;
    font-size: 32px;
    font-weight: 600;
    letter-spacing: -0.3px;
    color: var(--text-normal);
    line-height: 1.2; /* 恢复正常行高，防止文字溢出被切 */
    display: inline-block;
}

.code-dashboard-title-group .clickable-icon {
    margin: 0;
    padding: 0;
    height: 32px;
    width: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    border-radius: 4px;
    transition: color 0.15s ease, background-color 0.15s ease;
    background-color: transparent;
    border: none;
    cursor: pointer;
    flex-shrink: 0; /* 防止按钮变形 */
    /* 微调按钮位置以匹配视觉重心 */
    position: relative;
    top: 2px;
}

.code-dashboard-title-group .clickable-icon:hover {
    color: var(--text-normal);
    background-color: var(--background-modifier-hover);
}

.code-dashboard-title-group .clickable-icon svg {
    width: 20px;
    height: 20px;
    stroke-width: 2px;
}

.code-dashboard-subtitle {
    margin: 0;
    color: var(--text-muted);
    font-size: 14px;
    font-weight: 400;
    line-height: 1.5; /* 增加行高优化阅读体验 */
}

.code-dashboard-title-group .clickable-icon:hover {
    color: var(--text-normal);
    background-color: var(--background-modifier-hover);
}

.code-dashboard-title-group .clickable-icon svg {
    width: 20px;
    height: 20px;
}

.code-dashboard-subtitle {
    margin: 0;
    color: var(--text-muted);
    font-size: 14px;
    font-weight: 400;
}

/* Toolbar */
.code-dashboard-toolbar {
    display: flex;
    gap: 10px;
    margin-bottom: 24px;
    align-items: center;
    flex-wrap: wrap;
    padding: 16px 0;
    border-bottom: 1px solid var(--background-modifier-border);
}

/* Search Box */
.code-search-box {
    flex: 1;
    min-width: 220px;
    max-width: 400px;
    position: relative;
}

.code-search-box input {
    width: 100%;
    height: 32px;
    padding: 0 12px 0 32px;
    background-color: var(--background-modifier-form-field);
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    font-size: 13px;
    color: var(--text-normal);
    transition: border-color 0.1s ease, box-shadow 0.1s ease;
}

.code-search-box input:hover {
    border-color: var(--background-modifier-border-hover);
}

.code-search-box input:focus {
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px hsla(var(--interactive-accent-hsl), 0.15);
    outline: none;
}

.code-search-box input::placeholder {
    color: var(--text-faint);
}

.code-search-icon {
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-muted);
    display: flex;
    pointer-events: none;
}

.code-search-icon svg {
    width: 14px;
    height: 14px;
}

/* Custom Dropdown - 完全自定义的下拉组件 */
.custom-dropdown-wrapper {
	position: relative;
}

.custom-dropdown-select {
	display: flex;
	align-items: center;
	justify-content: space-between;
	gap: 8px;
	height: 32px;
	min-width: 120px;
	padding: 0 14px;
	background-color: var(--background-modifier-form-field);
	border: 1px solid var(--background-modifier-border);
	border-radius: 4px;
	cursor: pointer;
	transition: border-color 0.1s ease, box-shadow 0.1s ease;
	user-select: none;
}

.code-folder-filter-button {
	height: 32px;
	padding: 0 14px;
	background-color: var(--background-modifier-form-field);
	border: 1px solid var(--background-modifier-border);
	border-radius: 4px;
	font-size: 13px;
	color: var(--text-normal);
	cursor: pointer;
	display: inline-flex;
	align-items: center;
	justify-content: space-between;
	gap: 8px;
}

.code-folder-filter-button:hover {
	background-color: var(--background-modifier-hover);
	border-color: var(--interactive-accent);
}

.code-folder-filter-button:focus-visible {
	outline: none;
	box-shadow: 0 0 0 2px hsla(var(--interactive-accent-hsl), 0.2);
}

.custom-dropdown-select:hover {
	background-color: var(--background-modifier-hover);
	border-color: var(--interactive-accent);
}

.custom-dropdown-select.is-open {
	background-color: var(--background-modifier-hover);
	border-color: var(--interactive-accent);
	box-shadow: 0 0 0 2px hsla(var(--interactive-accent-hsl), 0.2);
}

.custom-dropdown-label {
	flex: 1;
	font-size: 13px;
	font-weight: 400;
	color: var(--text-normal);
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
}

.custom-dropdown-arrow {
	display: flex;
	align-items: center;
	justify-content: center;
	flex-shrink: 0;
	color: var(--text-muted);
}

.custom-dropdown-select.is-open .custom-dropdown-arrow {
	transform: rotate(180deg);
}

.custom-dropdown-menu {
	position: absolute;
	top: calc(100% + 4px);
	left: 0;
	right: 0;
	z-index: 1000;
	background-color: var(--background-primary);
	border: 1px solid var(--background-modifier-border);
	border-radius: 6px;
	box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
	overflow: hidden;
	max-height: 300px;
	overflow-y: auto;
}

.custom-dropdown-menu.is-hidden {
	display: none;
}

.custom-dropdown-item {
	display: flex;
	align-items: center;
	gap: 8px;
	padding: 8px 14px;
	font-size: 13px;
	color: var(--text-normal);
	cursor: pointer;
	overflow: hidden;
}

.custom-dropdown-item:hover {
	background-color: var(--background-modifier-hover);
}

.custom-dropdown-item.is-selected {
	background-color: hsla(var(--interactive-accent-hsl), 0.15);
	color: var(--interactive-accent);
	font-weight: 500;
}

.custom-dropdown-check {
	width: 14px;
	height: 14px;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	opacity: 0;
	color: var(--interactive-accent);
	flex-shrink: 0;
}

.custom-dropdown-check svg {
	width: 12px;
	height: 12px;
	stroke-width: 2px;
}

.custom-dropdown-item.is-selected .custom-dropdown-check {
	opacity: 1;
}

.custom-dropdown-text {
	flex: 1;
	min-width: 0;
	display: -webkit-box;
	-webkit-line-clamp: 2;
	-webkit-box-orient: vertical;
	white-space: normal;
	overflow: hidden;
	text-overflow: ellipsis;
	line-height: 1.3;
	max-height: 2.6em;
}

.custom-dropdown-clear {
	color: var(--text-muted);
	font-weight: 500;
}

/* Dropdown 滚动条样式 */
.custom-dropdown-menu::-webkit-scrollbar {
	width: 8px;
}

.custom-dropdown-menu::-webkit-scrollbar-track {
	background: transparent;
}

.custom-dropdown-menu::-webkit-scrollbar-thumb {
	background: var(--background-modifier-border-hover);
	border-radius: 4px;
	border: 1px solid transparent;
	background-clip: content-box;
}

.custom-dropdown-menu::-webkit-scrollbar-thumb:hover {
	background: var(--text-muted);
}

/* Buttons */
.code-dashboard-toolbar button {
    height: 32px;
    background-color: var(--interactive-normal);
    border: none;
    border-radius: 4px;
    padding: 0 14px;
    color: var(--text-normal);
    font-size: 13px;
    font-weight: 400;
    cursor: pointer;
    transition: background-color 0.1s ease;
    display: flex;
    align-items: center;
    gap: 6px;
}

.code-dashboard-toolbar button:hover {
    background-color: var(--background-modifier-hover);
    color: var(--text-normal);
}

.code-dashboard-toolbar button.clickable-icon {
    padding: 0 10px;
    background-color: transparent;
    border: none;
    color: var(--text-muted);
}

.code-dashboard-toolbar button.clickable-icon:hover {
    color: var(--interactive-accent);
    background-color: var(--background-modifier-hover);
}

.code-dashboard-toolbar button.clickable-icon svg {
    width: 16px;
    height: 16px;
}

/* File Grid */
.code-file-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 14px;
}

.code-file-item {
    display: flex;
    align-items: flex-start;
    flex-wrap: wrap;
    padding: 14px;
    background-color: var(--background-secondary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.1s ease, border-color 0.1s ease;
    position: relative;
}

.code-file-item:hover {
    background-color: var(--background-modifier-hover);
    border-color: var(--background-modifier-border-hover);
}

/* Icon */
.code-file-icon-box {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    background-color: var(--background-modifier-border);
    border-radius: 6px;
    margin-right: 14px;
    color: var(--text-muted);
    flex-shrink: 0;
    transition: background-color 0.1s ease, color 0.1s ease, transform 0.1s ease;
}

.code-file-item:hover .code-file-icon-box {
    background-color: var(--interactive-accent);
    color: var(--text-on-accent);
    transform: scale(1.02);
}

.code-file-icon-box svg {
    width: 20px;
    height: 20px;
    stroke-width: 1.5px;
}

/* Info */
.code-file-info {
    flex: 1;
    overflow: hidden;
    min-width: 0;
}

.code-file-name {
    font-size: 14px;
    font-weight: 500;
    letter-spacing: -0.1px;
    color: var(--text-normal);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: normal;
    line-height: 1.3;
    max-height: 2.6em;
}

.code-file-path {
    font-size: 12px;
    color: var(--text-muted);
    margin-top: 3px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    opacity: 0.8;
}

/* Metadata */
.code-file-meta {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 6px;
    margin-left: 12px;
}

.folder-filter-search-row {
	margin-bottom: 10px;
}

.folder-filter-search-row input {
	width: 100%;
}

.folder-filter-count {
	font-size: 12px;
	color: var(--text-muted);
	margin-bottom: 8px;
}

.folder-filter-list {
	max-height: 360px;
	overflow-y: auto;
	border: 1px solid var(--background-modifier-border);
	border-radius: 6px;
	padding: 6px 0;
	background-color: var(--background-primary);
}

.folder-filter-item {
	display: flex;
	align-items: flex-start;
	gap: 8px;
	padding: 8px 12px;
	cursor: pointer;
	border-radius: 4px;
}

.folder-filter-item:hover {
	background-color: var(--background-modifier-hover);
}

.folder-filter-item.is-selected {
	background-color: hsla(var(--interactive-accent-hsl), 0.15);
}

.folder-filter-check {
	width: 16px;
	height: 16px;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	color: var(--interactive-accent);
	opacity: 0;
	flex-shrink: 0;
	margin-top: 2px;
}

.folder-filter-item.is-selected .folder-filter-check {
	opacity: 1;
}

.folder-filter-text {
	flex: 1;
	min-width: 0;
	white-space: normal;
	word-break: break-word;
}

.folder-filter-empty {
	padding: 12px;
	color: var(--text-muted);
	text-align: center;
}

.folder-filter-footer {
	display: flex;
	justify-content: flex-end;
	gap: 8px;
	margin-top: 12px;
}

.code-file-tag-row {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 6px;
}

.code-file-tag {
    font-size: 10px;
    font-weight: 600;
    padding: 3px 6px;
    border-radius: 4px;
    background-color: var(--background-modifier-border);
    color: var(--text-muted);
    letter-spacing: 0.3px;
    text-transform: uppercase;
}

.code-file-external-badge {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
    border-radius: 4px;
    background-color: var(--background-modifier-border);
    color: var(--text-muted);
    opacity: 0.7;
}

.code-file-external-badge svg {
    width: 12px;
    height: 12px;
    stroke-width: 1.6px;
}

.code-file-item-external .code-file-external-badge {
    opacity: 0.9;
}

.code-file-time {
    font-size: 11px;
    color: var(--text-faint);
    font-variant-numeric: tabular-nums;
}

/* Empty State */
.code-empty-state {
    grid-column: 1 / -1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 100px 0;
    color: var(--text-muted);
}

.code-empty-icon svg {
    width: 48px;
    height: 48px;
    margin-bottom: 16px;
    opacity: 0.25;
}

.code-empty-state p {
    margin: 0;
    font-size: 15px;
    font-weight: 400;
}

/* =================================================================
   高亮配色
   ================================================================= */
.theme-light .cmt-keyword { color: var(--code-keyword, #af00db) !important; }
.theme-light .cmt-variableName { color: var(--code-value, #001080) !important; }
.theme-light .cmt-typeName { color: var(--code-class, #267f99) !important; }
.theme-light .cmt-function { color: var(--code-function, #795e26) !important; }
.theme-light .cmt-string { color: var(--code-string, #a31515) !important; }
.theme-light .cmt-comment { color: var(--code-comment, #008000) !important; }
.theme-light .cmt-number { color: var(--code-value, #098658) !important; }
.theme-light .cmt-operator { color: var(--code-operator, #383838) !important; }
.theme-light .cmt-punctuation { color: var(--code-punctuation, #383838) !important; }
.theme-light .cmt-meta { color: #800000 !important; }
.theme-dark .cmt-keyword { color: var(--code-keyword, #c678dd) !important; }
.theme-dark .cmt-variableName { color: var(--code-value, #e06c75) !important; }
.theme-dark .cmt-typeName { color: var(--code-class, #e5c07b) !important; }
.theme-dark .cmt-function { color: var(--code-function, #61afef) !important; }
.theme-dark .cmt-string { color: var(--code-string, #98c379) !important; }
.theme-dark .cmt-comment { color: var(--code-comment, #5c6370) !important; }
.theme-dark .cmt-number { color: var(--code-value, #d19a66) !important; }
.theme-dark .cmt-operator { color: var(--code-operator, #56b6c2) !important; }
.theme-dark .cmt-punctuation { color: var(--code-punctuation, #abb2bf) !important; }
.theme-dark .cmt-meta { color: #c678dd !important; }
.cmt-invalid { color: var(--text-error, #f00) !important; text-decoration: underline wavy; }
.cmt-link { color: var(--text-accent, #2d7fba) !important; text-decoration: underline; }
.theme-light .cm-content { caret-color: #000000; }
.theme-dark .cm-content { caret-color: #ffffff; }
.cm-selectionBackground { background-color: var(--text-selection) !important; }
.cm-activeLine { background-color: var(--background-modifier-active-hover) !important; }

/* =================================================================
   Code Embed Styles
   ================================================================= */

/* Override Obsidian's default file-embed styles to reduce padding */
.file-embed[data-code-space-rendered-for] {
	padding: 0;
	border: none;
	background: transparent;
}

.file-embed[data-code-space-rendered-for] .file-embed-title {
	display: none;
}

.code-embed-container {
	border: 1px solid var(--background-modifier-border);
	border-radius: 6px;
	margin: 4px 0;
	overflow: hidden;
	background-color: var(--background-primary);
}

.code-embed-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 4px 10px;
	background-color: var(--background-secondary);
	cursor: pointer;
	user-select: none;
}

.code-embed-header:hover {
	background-color: var(--background-modifier-hover);
}

.code-embed-filename {
	font-weight: 600;
	color: var(--text-normal);
	font-size: calc(var(--code-space-embed-font-size, 13px) - 1px);
}

.code-embed-linerange {
	font-size: calc(var(--code-space-embed-font-size, 13px) - 2px);
	color: var(--text-muted);
}

.code-embed-editor {
    background-color: var(--background-primary);
    text-align: left; /* 确保左对齐 */
    font-family: var(--font-monospace), 'JetBrains Mono', 'Fira Code', 'Cascadia Code', 'Source Code Pro', Consolas, 'Courier New', monospace;
    font-feature-settings: "liga" 1, "calt" 1;
    -webkit-font-smoothing: antialiased;
    cursor: text; /* 强制显示文本光标 */
    pointer-events: auto; /* 允许文本选择，但阻止打开文件 */
}

.code-embed-editor.code-embed-scrollable {
	max-height: var(--embed-max-height);
	overflow: hidden;
}

.code-embed-editor .cm-editor {
	height: auto;
	overflow: hidden;
	text-align: left; /* 确保编辑器内容左对齐 */
}

.code-embed-editor.code-embed-scrollable .cm-editor {
	height: 100%;
	max-height: inherit;
	overflow: hidden;
}


.code-embed-editor .cm-content {
	text-align: left; /* 确保内容左对齐 */
	padding-left: 0; /* 移除额外 padding */
	cursor: text; /* 强制显示文本光标 */
}

.code-embed-editor .cm-line {
	line-height: 20px; /* 确保每行精确为 20px 高度 */
}

.code-embed-editor .cm-scroller {
	overflow: auto;
}

/* Optimize embed editor scrollbar */
.code-embed-editor .cm-scroller::-webkit-scrollbar {
	width: 10px;
	height: 10px;
}

.code-embed-editor .cm-scroller::-webkit-scrollbar-track {
	background: transparent;
}

.code-embed-editor .cm-scroller::-webkit-scrollbar-thumb {
	background: var(--background-modifier-border-hover);
	border-radius: 5px;
	border: 2px solid transparent;
	background-clip: content-box;
}

.code-embed-editor .cm-scroller::-webkit-scrollbar-thumb:hover {
	background: var(--text-muted);
}

/* =================================================================
   Static Fallback for PDF Export
   ================================================================= */
.code-embed-static-fallback {
	display: none;
}

.code-embed-static {
	margin: 0;
	padding: 8px;
	background-color: var(--background-primary);
	border: none;
	border-radius: 0;
	overflow-x: auto;
	font-family: var(--font-monospace), 'JetBrains Mono', 'Fira Code', 'Cascadia Code', 'Source Code Pro', Consolas, 'Courier New', monospace;
	font-size: var(--code-space-embed-font-size, 13px);
	line-height: var(--code-space-embed-line-height, 20px);
}

.code-embed-static code {
	display: block;
	white-space: pre;
	word-wrap: normal;
	background: transparent;
	font-family: inherit;
	font-size: inherit;
	line-height: inherit;
}

/* PDF export optimization: show static fallback, hide interactive editor */
@media print {
	.code-embed-container {
		break-inside: avoid;
		border: 1px solid var(--background-modifier-border);
	}
	
	.code-embed-editor {
		display: none !important;
	}
	
	.code-embed-static-fallback {
		display: block !important;
	}
	
	.code-embed-static {
		max-height: none;
		overflow: visible;
	}
}

/* =================================================================
   CodeMirror Search Panel Styles - Obsidian Native Style
   ================================================================= */
.code-space-container .cm-panel {
    background-color: var(--background-secondary);
    border-top: 1px solid var(--background-modifier-border);
    padding: var(--size-4-2) var(--size-4-3);
}

.code-space-container .cm-search {
    display: flex;
    align-items: center;
    gap: var(--size-4-2);
    flex-wrap: wrap;
}

/* 搜索输入框 - 使用 Obsidian 原生输入框样式 */
.code-space-container .cm-searchQuery,
.code-space-container .cm-replaceQuery {
    flex: 1;
    min-width: 120px;
    height: var(--input-height, 30px);
    padding: 0 var(--size-4-2);
    background-color: var(--background-modifier-form-field);
    border: var(--input-border-width, 1px) solid var(--background-modifier-border);
    border-radius: var(--input-radius, 5px);
    color: var(--text-normal);
    font-size: var(--font-ui-small, 13px);
    font-family: var(--font-interface, var(--font-default));
    line-height: normal;
    transition: border-color var(--anim-duration-fast, 140ms) ease,
                box-shadow var(--anim-duration-fast, 140ms) ease,
                background-color var(--anim-duration-fast, 140ms) ease;
}

.code-space-container .cm-searchQuery:hover,
.code-space-container .cm-replaceQuery:hover {
    border-color: var(--background-modifier-border-hover);
    background-color: var(--background-modifier-form-field-hover, var(--background-modifier-form-field));
}

.code-space-container .cm-searchQuery:focus,
.code-space-container .cm-replaceQuery:focus {
    outline: none;
    border-color: var(--interactive-accent);
    border-width: var(--input-border-width-focus, 2px);
    box-shadow: 0 0 0 2px hsla(var(--interactive-accent-hsl), 0.15);
    background-color: var(--background-modifier-form-field-highlighted, var(--background-modifier-form-field));
}

.code-space-container .cm-searchQuery::placeholder,
.code-space-container .cm-replaceQuery::placeholder {
    color: var(--input-placeholder-color, var(--text-faint));
}

/* 搜索按钮 - Obsidian 风格 */
.code-space-container .cm-search button {
    min-width: var(--input-height, 30px);
    height: var(--input-height, 30px);
    padding: 0 var(--size-4-2);
    background-color: var(--interactive-normal);
    border: var(--border-width, 1px) solid var(--background-modifier-border);
    border-radius: var(--button-radius, var(--input-radius, 5px));
    color: var(--text-normal);
    font-size: var(--font-ui-small, 13px);
    font-weight: var(--input-font-weight, var(--font-normal, 400));
    cursor: pointer;
    transition: background-color var(--anim-duration-fast, 140ms) ease,
                border-color var(--anim-duration-fast, 140ms) ease,
                color var(--anim-duration-fast, 140ms) ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    white-space: nowrap;
}

.code-space-container .cm-search button:hover {
    background-color: var(--interactive-hover);
    border-color: var(--background-modifier-border-hover);
    color: var(--text-normal);
}

.code-space-container .cm-search button:active {
    background-color: var(--interactive-hover);
    transform: translateY(1px);
}

/* 激活状态按钮 */
.code-space-container .cm-search button.cm-search-button-active {
    background-color: var(--interactive-accent);
    border-color: var(--interactive-accent);
    color: var(--text-on-accent);
}

.code-space-container .cm-search button.cm-search-button-active:hover {
    background-color: var(--interactive-accent-hover);
    border-color: var(--interactive-accent-hover);
}

/* 禁用状态 */
.code-space-container .cm-search button[disabled] {
    opacity: 0.4;
    cursor: not-allowed;
    pointer-events: none;
}

/* 搜索匹配高亮 - 金黄色 (普通匹配) */
.code-space-container .cm-searchMatch {
    background-color: #FFD700 !important;
    border-radius: 2px;
    outline: 2px solid #FFD700;
    color: #000000 !important;
}

/* 当前选中的搜索匹配 - 淡红色 (当前焦点) */
.code-space-container .cm-searchMatch-selected {
    background-color: #FF5555 !important;
    border-radius: 2px;
    outline: 3px solid #FF5555;
    box-shadow: 0 0 8px rgba(255, 85, 85, 0.8);
    color: #FFFFFF !important;
}

.theme-dark .code-space-container .cm-searchMatch {
    background-color: #FFD700 !important;
    outline: 2px solid #FFD700;
    color: #000000 !important;
}

.theme-dark .code-space-container .cm-searchMatch-selected {
    background-color: #FF5555 !important;
    outline: 3px solid #FF5555;
    box-shadow: 0 0 10px rgba(255, 85, 85, 1);
    color: #FFFFFF !important;
}

/* 其他相同的词 - 金黄色 */
.code-space-container .cm-selectionMatch {
    background-color: rgba(255, 215, 0, 0.6) !important;
    color: #000000 !important;
    border-radius: 2px;
}

/* 隐藏分隔符 */
.code-space-container .cm-search + hr {
    display: none;
}

/* 隐藏 CodeMirror 默认的搜索面板 */
.code-space-container .cm-panel.cm-search {
    display: none !important;
}

/* =================================================================
   自定义搜索面板样式 - VS Code 风格
   ================================================================= */
.custom-search-panel {
    position: sticky !important;
    top: 0 !important;
    z-index: 1000 !important;
    background-color: var(--background-secondary);
    border-bottom: 1px solid var(--background-modifier-border);
    padding: 8px 12px;
    font-family: var(--font-interface);
    width: 100%;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.custom-search-row {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
}

.custom-search-row:last-child {
    margin-bottom: 0;
}

.custom-search-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 30px;
    height: 30px;
    color: var(--text-muted);
    flex-shrink: 0;
}

.custom-search-icon svg {
    width: 16px;
    height: 16px;
}

.custom-search-input {
    flex: 1;
    min-width: 200px;
    height: 32px;
    padding: 0 10px;
    background-color: var(--background-modifier-form-field);
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    color: var(--text-normal);
    font-size: 13px;
    font-family: var(--font-interface);
    transition: border-color 140ms ease, box-shadow 140ms ease;
}

.custom-search-input:hover {
    border-color: var(--background-modifier-border-hover);
}

.custom-search-input:focus {
    outline: none;
    border-color: var(--interactive-accent);
    border-width: 2px;
    box-shadow: 0 0 0 2px hsla(var(--interactive-accent-hsl), 0.15);
}

.custom-search-options {
    display: flex;
    gap: 2px;
}

.custom-search-option-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 30px;
    height: 30px;
    border-radius: 4px;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 140ms ease;
}

.custom-search-option-btn:hover {
    background-color: var(--background-modifier-hover);
    color: var(--text-normal);
}

.custom-search-option-btn.active {
    background-color: var(--interactive-accent);
    color: var(--text-on-accent);
}

.custom-search-option-btn svg {
    width: 18px;
    height: 18px;
}

.custom-search-nav {
    display: flex;
    gap: 2px;
    margin-left: auto;
}

.custom-search-nav-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 30px;
    height: 30px;
    border-radius: 4px;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 140ms ease;
}

.custom-search-nav-btn:hover {
    background-color: var(--background-modifier-hover);
    color: var(--text-normal);
}

.custom-search-nav-btn svg {
    width: 18px;
    height: 18px;
}

.custom-search-icon-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 30px;
    height: 30px;
    border-radius: 4px;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 140ms ease;
}

.custom-search-icon-btn:hover {
    background-color: var(--background-modifier-hover);
    color: var(--text-normal);
}

.custom-search-icon-btn svg {
    width: 18px;
    height: 18px;
}

.custom-search-replace-btns {
    display: flex;
    gap: 6px;
    margin-left: auto;
}

.custom-search-replace-btn {
    height: 30px;
    padding: 0 12px;
    background-color: var(--interactive-normal);
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    color: var(--text-normal);
    font-size: 13px;
    font-weight: 400;
    cursor: pointer;
    transition: all 140ms ease;
    white-space: nowrap;
}

.custom-search-replace-btn:hover {
    background-color: var(--interactive-hover);
    border-color: var(--background-modifier-border-hover);
}

.custom-search-replace-btn.mod-all {
    background-color: var(--interactive-normal);
}

.custom-search-replace-btn.mod-all:hover {
    background-color: var(--interactive-hover);
}

.is-hidden {
    display: none !important;
}

/* =================================================================
   代码大纲侧边栏
   ================================================================= */
.code-outline-header {
    padding: 16px 16px 8px 16px;
    margin: 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    border-bottom: 1px solid var(--background-modifier-border);
}

.code-outline-empty {
    text-align: center;
    color: var(--text-muted);
    font-size: 13px;
    padding: 20px 16px;
}



.code-outline-filename {
    padding: 12px 16px 8px 16px;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-muted);
    border-bottom: 1px solid var(--background-modifier-border);
}

.code-outline-list {
    padding: 8px 0;
}

.code-outline-list-inner {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.code-outline-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 16px;
    cursor: pointer;
    transition: background-color 140ms ease;
}

.code-outline-item:hover {
    background-color: var(--background-modifier-hover);
}

.code-outline-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    flex-shrink: 0;
    color: var(--text-muted);
}

.code-outline-icon svg {
    width: 14px;
    height: 14px;
}

.code-outline-info {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 8px;
    min-width: 0;
}

.code-outline-name {
    flex: 1;
    font-size: 13px;
    font-weight: 400;
    color: var(--text-normal);
    font-family: var(--font-monospace);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.code-outline-line {
    font-size: 11px;
    color: var(--text-faint);
    font-variant-numeric: tabular-nums;
    flex-shrink: 0;
}

/* Create File Modal */
.create-file-input-group {
    display: flex;
    gap: 8px;
    margin-bottom: 12px;
}

.create-file-filename-input {
    flex: 1;
}
